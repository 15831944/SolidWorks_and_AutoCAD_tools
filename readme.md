# SolidWorks+AutoCAD 快速出图解决方案    

## 背景    

现公司的三维设计流程为：SolidWorks(以下简称SW)创建三维模型->SW工程图->输出二维图纸->修改格式->套上标准图框->上传PLM软件进行图文档管理。为与PLM软件的签字系统兼容，要求SW输出的二维图纸必须是AutoCAD(以下简称CAD)支持的.dwg格式，但SW输出.dwg格式图纸存在诸如格式不标准、标注样式不标准、位置错乱、元素丢失、字体混乱等问题，以往输出的每张CAD图纸都需要手工进行格式调整，以满足图纸的标准化要求，在图纸张数很多时，工作量巨大且繁复。同时在输出多张二维图纸时需要每张图纸手动操作，造成重复劳动且容易遗漏文件。此解决方案就是为解决这些问题的提出。    
经统计，一张普通复杂度的A3图纸，使用该方案后能比原来节省15分钟以上的时间。  

## 方案介绍    

本解决方案分为SolidWoks设置和AutoCAD设置两部分，每部分下有各功能块，方案结构如下：    
解决方案    
    |---SolidWoks设置    
    |   |---01.异型孔标注配置文件修改    
    |   |---02.EasyProperty零件属性助手    
    |   |---03.映射文件    
    |   |---04.批量输出二维图纸    
    |---AutoCAD设置    
        |---01.SWDwgOpti优化插件    
        |---02.DwgFrameAssist图框助手    

>"EasyProperty零件属性助手"和"DwgFrameAssist图框助手"功能块有根据公司内部特殊定制，其余功能为通用功能。    

### SolidWoks设置功能块   

 
**01.异型孔标注配置文件修改**    
此为SW默认孔标注配置文件的修改版，主要用来修改SW中自带的孔标注样式。    
因为SW自带的孔标注样式会标注部分冗余的信息，且采用了最新版的孔系GB符号进行标注，与公司标准化字体不兼容。    


**02.EasyProperty零件属性助手**    
此为C# + WPF方式开发的一个SW外挂程序(非插件形式)，用来快速修改三维零部件的属性，而不用每次都去层层菜单中一个个点击。    

**03.映射文件**    
该映射文件在SW输出CAD图纸时使用，用来告知SW如何将SW图纸内的各实体映射为对应的CAD图纸内的不同图层、线型、颜色的实体。    


**04.批量输出二维图纸**    
此为SW的一个用VBA编写的插件(宏文件)"DrawingSaveAs.swp"。通过该插件可以一键将所有打开的SW图纸批量输出为PDF或CAD图纸。    

>经过上面SW侧的设置，就可以输出图层、颜色等正确的CAD图纸了，但输出的图纸中线性标注、粗糙度标注、公差标注、字体、技术要求等仍存在问题，需要在CAD端进行修改。    

### AutoCAD设置功能块    

**01.SWDwgOpti优化插件**    
此为基于VBA开发的一个AutoCAD插件，用于将SW输出的原始CAD图纸修改为符合公司标准化要求的CAD图纸。    


**02.DwgFrameAssist图框助手**    
此为基于C#开发的AutoCAD插件，主要用于代替PLM软件自带的刷新图框工具(简称刷图工具)，比自带的刷图工具更加方便、更加人性化。    
PLM自带的刷图工具有如下问题：    
1. 使用时必须打开笨拙、庞大的PLM软件；    
2. 只支持调用AutoCAD2004软件刷图，但公司很大部分的新电脑均为Win 7 x64系统，无法安装AutoCAD2004;    
3. 刷图工具是独立于AutoCAD的，即在AutoCAD中编辑图纸时，是无法更改图框的，若要更改图框，需关闭CAD重新刷图；
4. 批量刷图支持欠佳。 
   
本插件解决了上面的三个问题：    
1. 与PLM无关，嵌入AutoCAD运行；    
2. 运行环境依赖于AutoCAD，与操作系统版本及32bit/64bit无关；   
3. 在CAD中编辑图纸时，可随时修改图框；    
4. 完美支持批量刷图。    

## 安装方法    
此解决方案的各功能块彼此独立，无依赖关系，根据个人需求可全部安装，也可部分安装。    
安装方法详见各功能块文件夹内readme文件。    

---

by liy